<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 구획분석의 자료해석 | 신약개발을 위한 실전 약동학</title>
  <meta name="description" content="신약개발에 종사하는 연구자라면 반드시 알아야 하는 약동학 이론을 습득하고 실습을 통해 실전 지식을 갖출 수 있도록 짜여져 있습니다." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 구획분석의 자료해석 | 신약개발을 위한 실전 약동학" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://pipet.or.kr/books/pharmapk" />
  <meta property="og:image" content="http://pipet.or.kr/books/pharmapk/images/cover.jpg" />
  <meta property="og:description" content="신약개발에 종사하는 연구자라면 반드시 알아야 하는 약동학 이론을 습득하고 실습을 통해 실전 지식을 갖출 수 있도록 짜여져 있습니다." />
  <meta name="github-repo" content="pipetcpt/pharmapk" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 구획분석의 자료해석 | 신약개발을 위한 실전 약동학" />
  
  <meta name="twitter:description" content="신약개발에 종사하는 연구자라면 반드시 알아야 하는 약동학 이론을 습득하고 실습을 통해 실전 지식을 갖출 수 있도록 짜여져 있습니다." />
  <meta name="twitter:image" content="http://pipet.or.kr/books/pharmapk/images/cover.jpg" />

<meta name="author" content="가톨릭대학교 계량약리학연구소(PIPET) 펴냄 (대표저자 임동석)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ca-principle.html"/>
<link rel="next" href="참고문헌.html"/>
<script src="libs/header-attrs/header-attrs.js"></script>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">신약개발을 위한 실전 약동학</a></li>
<li><a href="#" target="_blank">도서 구입</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>머리말</a></li>
<li class="chapter" data-level="1" data-path="principle.html"><a href="principle.html"><i class="fa fa-check"></i><b>1</b> 약동학 기초 이론</a>
<ul>
<li class="chapter" data-level="1.1" data-path="principle.html"><a href="principle.html#서론"><i class="fa fa-check"></i><b>1.1</b> 서론</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="principle.html"><a href="principle.html#용어의-소개"><i class="fa fa-check"></i><b>1.1.1</b> 용어의 소개</a></li>
<li class="chapter" data-level="1.1.2" data-path="principle.html"><a href="principle.html#약동학을-공부하는-목적"><i class="fa fa-check"></i><b>1.1.2</b> 약동학을 공부하는 목적</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="principle.html"><a href="principle.html#adme와-약동학"><i class="fa fa-check"></i><b>1.2</b> ADME와 약동학</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="principle.html"><a href="principle.html#흡수absorption"><i class="fa fa-check"></i><b>1.2.1</b> 흡수(absorption)</a></li>
<li class="chapter" data-level="1.2.2" data-path="principle.html"><a href="principle.html#분포distribution"><i class="fa fa-check"></i><b>1.2.2</b> 분포(distribution)</a></li>
<li class="chapter" data-level="1.2.3" data-path="principle.html"><a href="principle.html#대사metabolism와-배설execretion"><i class="fa fa-check"></i><b>1.2.3</b> 대사(metabolism)와 배설(execretion)</a></li>
<li class="chapter" data-level="1.2.4" data-path="principle.html"><a href="principle.html#일차약동학first-order-kinetics과-반감기half-lifet12"><i class="fa fa-check"></i><b>1.2.4</b> 일차약동학(first-order kinetics)과 반감기(half-life:t<sub>1/2</sub>)</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="principle.html"><a href="principle.html#분포용적"><i class="fa fa-check"></i><b>1.3</b> 분포용적</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="principle.html"><a href="principle.html#약물의-분포"><i class="fa fa-check"></i><b>1.3.1</b> 약물의 분포</a></li>
<li class="chapter" data-level="1.3.2" data-path="principle.html"><a href="principle.html#분포용적의-개념과-계산방법"><i class="fa fa-check"></i><b>1.3.2</b> 분포용적의 개념과 계산방법</a></li>
<li class="chapter" data-level="1.3.3" data-path="principle.html"><a href="principle.html#vd와-약의-물리화학적-특성의-관계"><i class="fa fa-check"></i><b>1.3.3</b> V<sub>d</sub>와 약의 물리화학적 특성의 관계</a></li>
<li class="chapter" data-level="1.3.4" data-path="principle.html"><a href="principle.html#vd와-혈장단백결합률의-관계"><i class="fa fa-check"></i><b>1.3.4</b> V<sub>d</sub>와 혈장단백결합률의 관계</a></li>
<li class="chapter" data-level="1.3.5" data-path="principle.html"><a href="principle.html#vd가-약동학에-미치는-영향"><i class="fa fa-check"></i><b>1.3.5</b> V<sub>d</sub>가 약동학에 미치는 영향</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="principle.html"><a href="principle.html#청소율의-개념과-적용"><i class="fa fa-check"></i><b>1.4</b> 청소율의 개념과 적용</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="principle.html"><a href="principle.html#청소율의-이해"><i class="fa fa-check"></i><b>1.4.1</b> 청소율의 이해</a></li>
<li class="chapter" data-level="1.4.2" data-path="principle.html"><a href="principle.html#청소율과-k-t12의-관계"><i class="fa fa-check"></i><b>1.4.2</b> 청소율과 k, t<sub>1/2</sub>의 관계</a></li>
<li class="chapter" data-level="1.4.3" data-path="principle.html"><a href="principle.html#pk-파라미터들은-약마다-사람마다-다르다"><i class="fa fa-check"></i><b>1.4.3</b> PK 파라미터들은 약마다, 사람마다 다르다</a></li>
<li class="chapter" data-level="1.4.4" data-path="principle.html"><a href="principle.html#cl과-vd의-관계에-관한-고찰"><i class="fa fa-check"></i><b>1.4.4</b> CL과 V<sub>d</sub>의 관계에 관한 고찰</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="principle.html"><a href="principle.html#다회투여multiple-dose의-약동학"><i class="fa fa-check"></i><b>1.5</b> 다회투여(multiple dose)의 약동학</a></li>
<li class="chapter" data-level="1.6" data-path="principle.html"><a href="principle.html#정맥주입continuous-infusion의-약동학"><i class="fa fa-check"></i><b>1.6</b> 정맥주입(continuous infusion)의 약동학</a></li>
<li class="chapter" data-level="1.7" data-path="principle.html"><a href="principle.html#최종반감기의-개념과-주의점"><i class="fa fa-check"></i><b>1.7</b> 최종반감기의 개념과 주의점</a></li>
<li class="chapter" data-level="1.8" data-path="principle.html"><a href="principle.html#경구투여의-약동학"><i class="fa fa-check"></i><b>1.8</b> 경구투여의 약동학</a></li>
<li class="chapter" data-level="1.9" data-path="principle.html"><a href="principle.html#비선형-약동학"><i class="fa fa-check"></i><b>1.9</b> 비선형 약동학</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="principle.html"><a href="principle.html#비선형약동학과-선형약동학의-차이"><i class="fa fa-check"></i><b>1.9.1</b> 비선형약동학과 선형약동학의 차이</a></li>
<li class="chapter" data-level="1.9.2" data-path="principle.html"><a href="principle.html#비선형약동학과-용량의-관련성"><i class="fa fa-check"></i><b>1.9.2</b> 비선형약동학과 용량의 관련성</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="principle.html"><a href="principle.html#맺음말"><i class="fa fa-check"></i><b>1.10</b> 맺음말</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="비구획분석.html"><a href="비구획분석.html"><i class="fa fa-check"></i><b>2</b> 비구획분석</a>
<ul>
<li class="chapter" data-level="2.1" data-path="비구획분석.html"><a href="비구획분석.html#서론-1"><i class="fa fa-check"></i><b>2.1</b> 서론</a></li>
<li class="chapter" data-level="2.2" data-path="비구획분석.html"><a href="비구획분석.html#비구획분석의-기본-개념과-관심사"><i class="fa fa-check"></i><b>2.2</b> 비구획분석의 기본 개념과 관심사</a></li>
<li class="chapter" data-level="2.3" data-path="비구획분석.html"><a href="비구획분석.html#비구획분석의-파라미터의-산출"><i class="fa fa-check"></i><b>2.3</b> 비구획분석의 파라미터의 산출</a></li>
<li class="chapter" data-level="2.4" data-path="비구획분석.html"><a href="비구획분석.html#비구획분석에서-추정하는-파라미터"><i class="fa fa-check"></i><b>2.4</b> 비구획분석에서 추정하는 파라미터</a></li>
<li class="chapter" data-level="2.5" data-path="비구획분석.html"><a href="비구획분석.html#비구획분석의-개념-확장-항정상태에-대한-추정"><i class="fa fa-check"></i><b>2.5</b> 비구획분석의 개념 확장 – 항정상태에 대한 추정</a></li>
<li class="chapter" data-level="2.6" data-path="비구획분석.html"><a href="비구획분석.html#비구획분석-결과의-요약"><i class="fa fa-check"></i><b>2.6</b> 비구획분석 결과의 요약</a></li>
<li class="chapter" data-level="2.7" data-path="비구획분석.html"><a href="비구획분석.html#맺음말-1"><i class="fa fa-check"></i><b>2.7</b> 맺음말</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="nca-analysis.html"><a href="nca-analysis.html"><i class="fa fa-check"></i><b>3</b> 비구획 분석의 자료해석</a>
<ul>
<li class="chapter" data-level="3.1" data-path="nca-analysis.html"><a href="nca-analysis.html#서론-2"><i class="fa fa-check"></i><b>3.1</b> 서론</a></li>
<li class="chapter" data-level="3.2" data-path="nca-analysis.html"><a href="nca-analysis.html#nca를-위한-자료의-처리"><i class="fa fa-check"></i><b>3.2</b> NCA를 위한 자료의 처리</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="nca-analysis.html"><a href="nca-analysis.html#채혈-시간"><i class="fa fa-check"></i><b>3.2.1</b> 채혈 시간</a></li>
<li class="chapter" data-level="3.2.2" data-path="nca-analysis.html"><a href="nca-analysis.html#정량한계를-벗어나거나-누락된-자료의-처리"><i class="fa fa-check"></i><b>3.2.2</b> 정량한계를 벗어나거나 누락된 자료의 처리</a></li>
<li class="chapter" data-level="3.2.3" data-path="nca-analysis.html"><a href="nca-analysis.html#자료의-제외"><i class="fa fa-check"></i><b>3.2.3</b> 자료의 제외</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="nca-analysis.html"><a href="nca-analysis.html#상용-소프트웨어를-이용한-nca"><i class="fa fa-check"></i><b>3.3</b> 상용 소프트웨어를 이용한 NCA</a></li>
<li class="chapter" data-level="3.4" data-path="nca-analysis.html"><a href="nca-analysis.html#nca에-활용할-수-있는-r-package-소개"><i class="fa fa-check"></i><b>3.4</b> NCA에 활용할 수 있는 R package 소개</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="nca-analysis.html"><a href="nca-analysis.html#r-4.x.x의-설치-윈도우-환경"><i class="fa fa-check"></i><b>3.4.1</b> R 4.x.x의 설치 (윈도우 환경)</a></li>
<li class="chapter" data-level="3.4.2" data-path="nca-analysis.html"><a href="nca-analysis.html#rstudio-설치-윈도우-환경"><i class="fa fa-check"></i><b>3.4.2</b> Rstudio 설치 (윈도우 환경)</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="nca-analysis.html"><a href="nca-analysis.html#nca를-위한-데이터셋의-작성"><i class="fa fa-check"></i><b>3.5</b> NCA를 위한 데이터셋의 작성</a></li>
<li class="chapter" data-level="3.6" data-path="nca-analysis.html"><a href="nca-analysis.html#loading"><i class="fa fa-check"></i><b>3.6</b> 자료 불러오기</a></li>
<li class="chapter" data-level="3.7" data-path="nca-analysis.html"><a href="nca-analysis.html#noncompart-r-패키지를-이용한-nca"><i class="fa fa-check"></i><b>3.7</b> NonCompart R 패키지를 이용한 NCA</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="nca-analysis.html"><a href="nca-analysis.html#tblnca-전체-대상자-nca"><i class="fa fa-check"></i><b>3.7.1</b> tblNCA(): 전체 대상자 NCA</a></li>
<li class="chapter" data-level="3.7.2" data-path="nca-analysis.html"><a href="nca-analysis.html#snca"><i class="fa fa-check"></i><b>3.7.2</b> sNCA()</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="nca-analysis.html"><a href="nca-analysis.html#nca-보고서"><i class="fa fa-check"></i><b>3.8</b> NCA 보고서</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="nca-analysis.html"><a href="nca-analysis.html#txtnca"><i class="fa fa-check"></i><b>3.8.1</b> txtNCA()</a></li>
<li class="chapter" data-level="3.8.2" data-path="nca-analysis.html"><a href="nca-analysis.html#pdfnca"><i class="fa fa-check"></i><b>3.8.2</b> pdfNCA()</a></li>
<li class="chapter" data-level="3.8.3" data-path="nca-analysis.html"><a href="nca-analysis.html#rtfnca"><i class="fa fa-check"></i><b>3.8.3</b> rtfNCA()</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="nca-analysis.html"><a href="nca-analysis.html#nca의-시각화-plotpk"><i class="fa fa-check"></i><b>3.9</b> NCA의 시각화 plotPK()</a></li>
<li class="chapter" data-level="3.10" data-path="nca-analysis.html"><a href="nca-analysis.html#parameters"><i class="fa fa-check"></i><b>3.10</b> 파라메터의 의미</a></li>
<li class="chapter" data-level="3.11" data-path="nca-analysis.html"><a href="nca-analysis.html#기술통계-descriptive-statistics"><i class="fa fa-check"></i><b>3.11</b> 기술통계 (Descriptive statistics)</a></li>
<li class="chapter" data-level="3.12" data-path="nca-analysis.html"><a href="nca-analysis.html#nca-후-생물학적-동등성-판별-bioequivalence"><i class="fa fa-check"></i><b>3.12</b> NCA 후 생물학적 동등성 판별 {#bioequivalence}</a>
<ul>
<li class="chapter" data-level="3.12.1" data-path="nca-analysis.html"><a href="nca-analysis.html#이론"><i class="fa fa-check"></i><b>3.12.1</b> 이론</a></li>
<li class="chapter" data-level="3.12.2" data-path="nca-analysis.html"><a href="nca-analysis.html#be-r-패키지를-사용한-생물학적-동등성-판정"><i class="fa fa-check"></i><b>3.12.2</b> BE R 패키지를 사용한 생물학적 동등성 판정</a></li>
</ul></li>
<li class="chapter" data-level="3.13" data-path="nca-analysis.html"><a href="nca-analysis.html#웹브라우저를-통한-nca-및-생물학적동등성-판정"><i class="fa fa-check"></i><b>3.13</b> 웹브라우저를 통한 NCA 및 생물학적동등성 판정</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ca-principle.html"><a href="ca-principle.html"><i class="fa fa-check"></i><b>4</b> 구획분석의 이론</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ca-principle.html"><a href="ca-principle.html#구획분석의-개념"><i class="fa fa-check"></i><b>4.1</b> 구획분석의 개념</a></li>
<li class="chapter" data-level="4.2" data-path="ca-principle.html"><a href="ca-principle.html#구획모델이-필요한-이유"><i class="fa fa-check"></i><b>4.2</b> 구획모델이 필요한 이유</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ca-principle.html"><a href="ca-principle.html#최종반감기와-관련한-이슈"><i class="fa fa-check"></i><b>4.2.1</b> 최종반감기와 관련한 이슈</a></li>
<li class="chapter" data-level="4.2.2" data-path="ca-principle.html"><a href="ca-principle.html#정확한-cmax-tmax-값의-추정"><i class="fa fa-check"></i><b>4.2.2</b> 정확한 C<sub>max</sub>, T<sub>max</sub> 값의 추정</a></li>
<li class="chapter" data-level="4.2.3" data-path="ca-principle.html"><a href="ca-principle.html#pkpd와-연관된-각종-의사결정"><i class="fa fa-check"></i><b>4.2.3</b> PK/PD와 연관된 각종 의사결정</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ca-principle.html"><a href="ca-principle.html#구획모델로-얻은-pk-파라미터와-nca로-얻은-pk-파라미터들의-차이점"><i class="fa fa-check"></i><b>4.3</b> 구획모델로 얻은 PK 파라미터와 NCA로 얻은 PK 파라미터들의 차이점*</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ca-principle.html"><a href="ca-principle.html#분포용적-파라미터들의-차이"><i class="fa fa-check"></i><b>4.3.1</b> 분포용적 파라미터들의 차이</a></li>
<li class="chapter" data-level="4.3.2" data-path="ca-principle.html"><a href="ca-principle.html#β와-kek10의-차이"><i class="fa fa-check"></i><b>4.3.2</b> β와 k<sub>e</sub>(k<sub>10</sub>)의 차이</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ca-principle.html"><a href="ca-principle.html#맺음말-2"><i class="fa fa-check"></i><b>4.4</b> 맺음말</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ca-analysis.html"><a href="ca-analysis.html"><i class="fa fa-check"></i><b>5</b> 구획분석의 자료해석</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ca-analysis.html"><a href="ca-analysis.html#서론-3"><i class="fa fa-check"></i><b>5.1</b> 서론</a></li>
<li class="chapter" data-level="5.2" data-path="ca-analysis.html"><a href="ca-analysis.html#상용-소프트웨어를-이용한-구획-분석-개론"><i class="fa fa-check"></i><b>5.2</b> 상용 소프트웨어를 이용한 구획 분석 개론</a></li>
<li class="chapter" data-level="5.3" data-path="ca-analysis.html"><a href="ca-analysis.html#구획분석에-활용할-수-있는-r-package-소개"><i class="fa fa-check"></i><b>5.3</b> 구획분석에 활용할 수 있는 R package 소개</a></li>
<li class="chapter" data-level="5.4" data-path="ca-analysis.html"><a href="ca-analysis.html#구획모델을-이용한-경구투여-후-약동학-자료-분석"><i class="fa fa-check"></i><b>5.4</b> 1구획모델을 이용한 경구투여 후 약동학 자료 분석</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="ca-analysis.html"><a href="ca-analysis.html#compartmental-analysis-without-tlag"><i class="fa fa-check"></i><b>5.4.1</b> Compartmental analysis without Tlag</a></li>
<li class="chapter" data-level="5.4.2" data-path="ca-analysis.html"><a href="ca-analysis.html#compartmental-analysis-with-tlag"><i class="fa fa-check"></i><b>5.4.2</b> Compartmental analysis with Tlag</a></li>
<li class="chapter" data-level="5.4.3" data-path="ca-analysis.html"><a href="ca-analysis.html#modeling-result"><i class="fa fa-check"></i><b>5.4.3</b> Modeling Result</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="ca-analysis.html"><a href="ca-analysis.html#구획모델을-이용한-정맥주사-후-약동학-자료-분석"><i class="fa fa-check"></i><b>5.5</b> 1구획모델을 이용한 정맥주사 후 약동학 자료 분석</a></li>
<li class="chapter" data-level="5.6" data-path="ca-analysis.html"><a href="ca-analysis.html#compartmental-analysis"><i class="fa fa-check"></i><b>5.6</b> Compartmental analysis</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="ca-analysis.html"><a href="ca-analysis.html#modeling-result-1"><i class="fa fa-check"></i><b>5.6.1</b> Modeling Result</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="ca-analysis.html"><a href="ca-analysis.html#구획모델-경구-흡수-이용한-약동학-자료-분석"><i class="fa fa-check"></i><b>5.7</b> 2구획모델 경구 흡수 이용한 약동학 자료 분석</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="ca-analysis.html"><a href="ca-analysis.html#compartmental-analysis-without-tlag-1"><i class="fa fa-check"></i><b>5.7.1</b> Compartmental analysis without Tlag</a></li>
<li class="chapter" data-level="5.7.2" data-path="ca-analysis.html"><a href="ca-analysis.html#compartmental-analysis-with-tlag-1"><i class="fa fa-check"></i><b>5.7.2</b> Compartmental analysis with Tlag</a></li>
<li class="chapter" data-level="5.7.3" data-path="ca-analysis.html"><a href="ca-analysis.html#modeling-result-2"><i class="fa fa-check"></i><b>5.7.3</b> Modeling Result</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="ca-analysis.html"><a href="ca-analysis.html#theoph-약동학-자료의-구획분석"><i class="fa fa-check"></i><b>5.8</b> Theoph 약동학 자료의 구획분석</a></li>
<li class="chapter" data-level="5.9" data-path="ca-analysis.html"><a href="ca-analysis.html#결론"><i class="fa fa-check"></i><b>5.9</b> 결론</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="참고문헌.html"><a href="참고문헌.html"><i class="fa fa-check"></i>참고문헌</a></li>
<li class="divider"></li>
<li><a href="https://pipetcpt.github.io/pharmapk/pharmapk.pdf">PDF 보기</a></li>
<li><a href="http://pipet.or.kr/books/" target="_blank">Published by PIPET</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">신약개발을 위한 실전 약동학</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ca-analysis" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> 구획분석의 자료해석</h1>
<p>한성필
</p>
<div id="서론-3" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> 서론</h2>
<p>약동학 구획분석을 한문장으로 표현하자면 시간 농도(time‐concentration data) 자료에 대한 약동학 파라메터 추정값(pharmacokinetic parameter estimates)을 구하는 과정이다.
다시 말하자면, 인체의 여러 장기(organ) 혹은 계(system)를 몇개의 구획으로 단순화하여 우리의 관심이 되는 특성을 파라메터화하여 각 구획들 간의 연관성을 파악하는 것이다.
약동학 파라메터의 추정을 위해서 약 30년 전부터 비선형 회귀분석(nonlinear regression analysis)이 사용 되어 왔고 현재 이 방식은 집단 약동학 분석에서 가장 필수적인 방법론으로 자리 잡은 상태이다.
추정에는 약동학 수식이 필요한데, 비선형 회귀분석 시 모형식(model formulation)으로 사용되며, 이 수식 안에 우리가 추정하고자 하는 약동학 파라메터가 모두 포함되어 있다.</p>
<p>구획간의 약물 이동은 1차 역학 (1st-order kinetics) 또는 선형 약동학(linear pharmacokinetics)을 따른다고 가정하게 된다.
선형 약동학이란 간단히 말해서 용량이 두배가 되면 농도도 두 배가 되는 것을 말하며, D (용량) → C (농도) 로 나타낼 경우 2D → 2C 의 관계가 성립하는 것을 말한다.
1구획 모델에서는 구획들 간의 약물 분포가 역학적으로 균일하다는 가정 하에 인체를 역학적 단일구획으로 기술한다.
1구획 모델에서는 약물이 작용부위로 신속히 이동한다고 가정하며 혈장을 자료 분석의 기준 구획으로 사용한다.
1구획 모델의 혈장농도 로그값은 시간에 대해 일직선적으로 감소하는 양상을 나타낸다.
2구획 모델에서는 구획들 간의 약물 분포가 역학적으로 균일하지 않다고 보며 인체를 중심 구획 (central compartment) 과 말초구획 (peripheral compartment)로 나누어 기술한다.
중심구획은 관류(perfusion)가 빠른 기관(예: 간, 신장)을 나타내는데 이는 약물의 분포와 관계하고 α phase 로 나타낸다.
반면 말초구획은 관류가 느린 기관(예: 근육, 지방)을 나타내며 이는 약물의 소실과 관계하고 β phase 로 나타낸다.
2구획 모델의 혈장농도 로그값은 시간에 대해 기울기가 두 개인 이직선적으로 감소하는 양상을 나타내는데, 처음의 빠른 기울기는 분포기를 나타내고, 나중의 느린 기울기는 소실기를 나타내게 된다.</p>
<div class="figure" style="text-align: center"><span id="fig:fig5-1"></span>
<img src="media-05/fig5-1.png" alt="3구획 약동학 모델에서 시간에 따른 농도 변화의 양상에 대한 모식도" width="100%" />
<p class="caption">
그림 5.1: 3구획 약동학 모델에서 시간에 따른 농도 변화의 양상에 대한 모식도
</p>
</div>
<p>정맥주사 후 3구획 모델을 비유를 들어 설명하자면, 구획을 나타내는 원통이 그림 <a href="ca-analysis.html#fig:fig5-1">5.1</a>과 같이 세 개가 있다고 가정을 할 수 있다.
약물을 정맥주사(IV bolus, 정주)하면 정주 직후에 혈중 농도가 최대에 도달하였다가 시간이 지남에 따라 감소하게 되는데, 구획간의 분포 및 제거에 의해 약물의 농도가 감소를 하게 된다.
여기서 V1은 중심구획, V2는 rapid peripheral compartment이고, V3은 slow peripheral compartment이다.
V1, V2, V3 원통의 부피는 약물이 분포하는 용적이고, 높이는 농도에 해당한다.
수평의 연결 파이프에 의해 약물이 분포 및 제거된다.
정주 후 초기에는 약물이 주로 V1에서 V2로 이동하면서 혈중농도가 급격하게 감소하고(rapid distribution phase), 그 이후에는 V1에서 V3로 약물이 이동하면서 동시에 V2에서는 거꾸로 V1으로 이동하며 전체적으로는 혈중농도가 감소(slow distribution phase)하게 된다.
그 후에는 V2, V3에서의 약물은 V1으로 이동해 나오면서 동시에 V1에서는 elimination이 일어나 농도가 아주 서서히 감소하게 된다. (terminal phase)</p>
<p>이렇게 약물의 이동에 대한 정량적인 표현을 위해서는 약동학 수식에 대해 익숙해 져야 할 필요가 있고, 수식을 잘 아는 것 만큼이나 자료를 해석하고 추정값을 실제로 구하는 작업을 충분히 경험할 필요가 있다.</p>
</div>
<div id="상용-소프트웨어를-이용한-구획-분석-개론" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> 상용 소프트웨어를 이용한 구획 분석 개론</h2>
<div class="figure" style="text-align: center"><span id="fig:fig5-2"></span>
<img src="media-05/fig5-2.png" alt="다양한 상용 소프트웨어의 사용 예. A. GUI 기반 Phoenix NLME, B. GUI 기반 Lixoft Monolix, C. NONMEM의 제어구문" width="100%" />
<p class="caption">
그림 5.2: 다양한 상용 소프트웨어의 사용 예. A. GUI 기반 Phoenix NLME, B. GUI 기반 Lixoft Monolix, C. NONMEM의 제어구문
</p>
</div>
<p>비선형 회귀분석(Nonlinear regression analysis)이 필요한 구획분석을 위해서는 컴퓨터 소프트웨어의 사용이 필수적이다.
이 때 Certara Phoenix NLME, Monolix와 같은 여러가지 소프트웨어들이 사용되고 있지만, 가장 널리쓰이는 도구는 ICON사의 NONMEM이라고 하는 소프트웨어이다. (그림 <a href="ca-analysis.html#fig:fig5-2">5.2</a>)
이것은 FORTRAN 코드로 프로그램 되었으며 현재 버전 7.5.0까지 지속적으로 업데이트 되고 있는 소프트웨어로, 현재 구획분석 및 계량약리학 분야에서 가장 표준적인 도구로 생각되고 있다.
이에 대한 각종 자료를 이곳에서 다루기는 지면의 제약과 이론의 어려움 때문에 별도의 참고서적을 활용하는 것이 바람직할 것이다.</p>
<p>상용 소프트웨어를 통한 구획분석 방법은 GUI 기반이고 많은 사용자가 확보되어 있다는 장점이 있으나, 상당한 비용을 매년 지불하여야 하며, 접근이 다소 쉽지 않다는 단점을 가지고 있다.</p>
</div>
<div id="구획분석에-활용할-수-있는-r-package-소개" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> 구획분석에 활용할 수 있는 R package 소개</h2>
<p>이를 극복하기 위해 통계 및 수학적 계산에 적합한 R 언어 기반의 오픈소스 소프트웨어가 활발히 개발되고 있다.
즉, 비구획분석을 위한 R 패키지를 3장에서 소개한 것과 마찬가지로 구획분석용 R 패키지에 대한 다양한 시도가 일어나고 있는 것이다.
본 서에서는 무료 R 패키지 “wnl”를 사용한 자료해석과 예제에 대해 다루고자 한다. <span class="citation">(<a href="#ref-R-wnl" role="doc-biblioref">Bae 2020c</a>)</span></p>
<p>NONMEM에서는 비선형 회귀분석을 위해서 최대 우도 추정법(maximum likelihood estimation)을 사용한다.
최대 우도 추정법에서 sample데이터에서 Y가 현재 측정된 값, E(Y)는 model에 의해 각각의 관측 지점에서의 예상되는 값, 그리고 V(Y)를 그 모델의 분산으로 표현한다.
이 때 모델에 주어진 관측값에 대한 우도(likelihood)는 다음과 같이 표현될 수 있다.</p>
<p><span class="math display" id="eq:eq5-2">\[\begin{equation}
L = \frac{1}{\sqrt{2\pi V(Y)}} \cdot e^{-\frac{1}{2V(Y)}\cdot(Y-E(Y))^2}
\tag{5.1}
\end{equation}\]</span></p>
<p>이때 이 일련의 관찰 값에 대한 우도는 개개인 관찰값의 확률을 통해 나오게 된다.
따라서 n개의 관찰값이 있으면 그 종합된 우도는 n개의 개개인별 확률이 되고 subject에 대한 우도는 다음과 같이 계산된다.</p>
<p><span class="math display" id="eq:eq5-2">\[\begin{equation}
L_i = \prod_{j=1}^{n_i}\frac{1}{\sqrt{2\pi V(Y_{ij})}} \cdot e^{-\frac{1}{2V(Y_{ij})}\cdot(Y_{ij}-E(Y_{ij}))^2}
\tag{5.1}
\end{equation}\]</span></p>
<p>이것은 -2 로그 우도로(-2 log likelihood) 전환 될 수 있으며, 이것은 다음과 같이 표현된다.</p>
<p><span class="math display" id="eq:eq5-3">\[\begin{equation}
-2log(L_i) = n_i \cdot log(2\pi) + \sum_{j=1}^{n}(log(V(Y_{ij}))+ \frac{(Y_{ij} - E(Y_{ij}))^2}{V(Y_{ij})})
\tag{5.2}
\end{equation}\]</span></p>
<p>결국 NONMEM은 이 -2 로그 우도의 값을 최소화 하는 방식으로 표현된다. 이 때, 우측 수식에서 앞에있는 n<sub>i</sub>log(2π)는 상수이기 때문에 실제 I번째 대상에서의 objection function은 다음과 같이 나타난다.</p>
<p><span class="math display" id="eq:eq5-4">\[\begin{equation}
OBJ_i = n_i \cdot logV(Y_i) + \sum_{j=1}^{n} \frac{(Y_{ij} - E(Y_{ij}))^2}{V(Y_{ij})}
\tag{5.3}
\end{equation}\]</span></p>
<p>실제 여기에서 derivation 을 정규 분포에만 적용한 것이 최대 우도 측정법 (maximum likelihood estimation method)<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>이라면, 정규 분포라는 가정 없이도 적용한 것이 NONMEM 소프트 웨어 이며 이 방식을 ‘확장된 최소 제곱법’(extended least square method)이라고 한다.</p>
<p>이 책의 예제에서는 NONMEM<sup>®</sup> 의 확장된 최소 제곱법을 적용한 ‘nlr’ function을 사용하였다.</p>
<p>각 모델에 맞는 적합한 모델에 따라 다음과 같은 script 형태로 입력해 주게
되며, 그에 대한 표준 오차(standard error of estimates), 공분산
행렬(covariance matrix of estimates), run test results on residuals,
AIC, AICc, SBC를 내부 계산을 통하여 도출하게 된다.</p>
<p>이때 run test란 residual들이 random하게 분포하는지를 보기 위해서 각각의
residual에서 최대 양수와 음수가 연속구간의 길이가 얼마나 되는지를 보는
방법이다. 이 때 계산된 p vaue를 통해서 실제로 residual이 random하게
분포하는지, 편향되게 분포하는지를 고려해 볼 수 있다.</p>
<p>AIC, AICc, SBC는 Akaike information criterion, Akaike information
criterion corrected, Schwarz criterion을 의미하며 각각의 통계적 모델에서
구조가 적합한지를 확인할수 있도록 도와주는 지표이다.</p>
</div>
<div id="구획모델을-이용한-경구투여-후-약동학-자료-분석" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> 1구획모델을 이용한 경구투여 후 약동학 자료 분석</h2>
<p>아래의 코드로 <code>wnl</code> 라이브러리를 불러오고 hands-on1.csv<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> 파일을 읽어올 수 있다.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="ca-analysis.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wnl)</span>
<span id="cb31-2"><a href="ca-analysis.html#cb31-2" aria-hidden="true" tabindex="-1"></a>dPK02 <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/hands-on1.csv&quot;</span>, <span class="at">skip=</span><span class="dv">1</span>)</span>
<span id="cb31-3"><a href="ca-analysis.html#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dPK02) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;TIME&quot;</span>, <span class="st">&quot;DV&quot;</span>)</span>
<span id="cb31-4"><a href="ca-analysis.html#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dPK02[,<span class="st">&quot;TIME&quot;</span>], dPK02[,<span class="st">&quot;DV&quot;</span>], <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">400</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>), </span>
<span id="cb31-5"><a href="ca-analysis.html#cb31-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Time (min)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Concentration (ug/L)&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>)</span></code></pre></div>
<p><img src="pharmapk_files/figure-html/unnamed-chunk-25-1.svg" width="100%" style="display: block; margin: auto;" /></p>
<p>먼저 NCA 분석을 수행한다. Tmax는 40분, Cmax는 2.00 ug/L인 것을 알 수 있다.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="ca-analysis.html#cb32-1" aria-hidden="true" tabindex="-1"></a>NonCompart<span class="sc">::</span><span class="fu">sNCA</span>(dPK02[,<span class="st">&quot;TIME&quot;</span>], dPK02[,<span class="st">&quot;DV&quot;</span>], </span>
<span id="cb32-2"><a href="ca-analysis.html#cb32-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dose=</span><span class="dv">100</span>, <span class="at">doseUnit=</span><span class="st">&quot;ug&quot;</span>, <span class="at">timeUnit=</span><span class="st">&quot;min&quot;</span>)</span></code></pre></div>
<pre><code>##         b0       CMAX      CMAXD       TMAX       TLAG 
##  1.558e+00  2.000e+00  2.000e-02  4.000e+01  1.000e+01 
##       CLST      CLSTP       TLST     LAMZHL       LAMZ 
##  1.800e-01  1.648e-01  3.600e+02  7.425e+01  9.335e-03 
##     LAMZLL     LAMZUL    LAMZNPT     CORRXY         R2 
##  9.000e+01  3.600e+02  7.000e+00 -9.822e-01  9.647e-01 
##      R2ADJ     AUCLST     AUCALL     AUCIFO    AUCIFOD 
##  9.577e-01  3.309e+02  3.309e+02  3.502e+02  3.502e+00 
##     AUCIFP    AUCIFPD     AUCPEO     AUCPEP    AUMCLST 
##  3.485e+02  3.485e+00  5.507e+00  5.064e+00  4.231e+04 
##    AUMCIFO    AUMCIFP    AUMCPEO    AUMCPEP       VZFO 
##  5.131e+04  5.055e+04  1.755e+01  1.631e+01  3.059e+01 
##       VZFP       CLFO       CLFP   MRTEVLST   MRTEVIFO 
##  3.073e+01  2.856e-01  2.869e-01  1.279e+02  1.465e+02 
##   MRTEVIFP 
##  1.450e+02 
## attr(,&quot;units&quot;)
##  [1] &quot;&quot;            &quot;ug/L&quot;        &quot;ug/L/ug&quot;    
##  [4] &quot;min&quot;         &quot;min&quot;         &quot;ug/L&quot;       
##  [7] &quot;ug/L&quot;        &quot;min&quot;         &quot;min&quot;        
## [10] &quot;/min&quot;        &quot;min&quot;         &quot;min&quot;        
## [13] &quot;&quot;            &quot;&quot;            &quot;&quot;           
## [16] &quot;&quot;            &quot;min*ug/L&quot;    &quot;min*ug/L&quot;   
## [19] &quot;min*ug/L&quot;    &quot;min*ug/L/ug&quot; &quot;min*ug/L&quot;   
## [22] &quot;min*ug/L/ug&quot; &quot;%&quot;           &quot;%&quot;          
## [25] &quot;min2*ug/L&quot;   &quot;min2*ug/L&quot;   &quot;min2*ug/L&quot;  
## [28] &quot;%&quot;           &quot;%&quot;           &quot;L&quot;          
## [31] &quot;L&quot;           &quot;L/min&quot;       &quot;L/min&quot;      
## [34] &quot;min&quot;         &quot;min&quot;         &quot;min&quot;        
## attr(,&quot;UsedPoints&quot;)
## [1]  7  8  9 10 11 12 13</code></pre>
<p>아래에서 경구 복용 후 1차 지수로 감소하는 약물에서의 약동학 모형을 사용한다.
이 경우에는 wnl 패키지 내부에 기본적 equation이 정의되어 있으므로 추가적인 equation을 입력하지 않고 각각의 파라미터의 값에 해당하는 THETA에 대해서만 입력하였다.
필요한 THETA는 k(제거 속도 상수), k<sub>a</sub>(흡수 속도 상수), V(부피), t<sub>lag</sub>(흡수가 지연되는 시간)이다.</p>
<div id="compartmental-analysis-without-tlag" class="section level3" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Compartmental analysis without Tlag</h3>
<p>아래는 경구 투여 일구획 분석, 지연시간이 없는 모형이다.
모델의 R script 입력 여기서 THETA[1], THETA[2], THETA[3]는 각각 파라미터 중 k(제거 속도 상수), k<sub>a</sub>(흡수 속도 상수), V(부피)를 의미한다.
각각의 nonlinear regression을 위해서 theta에 대한 initial value를 넣어준다. (<code>nlr()</code> 함수의 <code>IE()</code> 인자에 적용)</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="ca-analysis.html#cb34-1" aria-hidden="true" tabindex="-1"></a>DOSE <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb34-2"><a href="ca-analysis.html#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="ca-analysis.html#cb34-3" aria-hidden="true" tabindex="-1"></a>fPK02a <span class="ot">=</span> <span class="cf">function</span>(THETA) <span class="co"># Prediction function</span></span>
<span id="cb34-4"><a href="ca-analysis.html#cb34-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb34-5"><a href="ca-analysis.html#cb34-5" aria-hidden="true" tabindex="-1"></a>  Ka <span class="ot">=</span> THETA[<span class="dv">1</span>]</span>
<span id="cb34-6"><a href="ca-analysis.html#cb34-6" aria-hidden="true" tabindex="-1"></a>  V  <span class="ot">=</span> THETA[<span class="dv">2</span>]</span>
<span id="cb34-7"><a href="ca-analysis.html#cb34-7" aria-hidden="true" tabindex="-1"></a>  K  <span class="ot">=</span> THETA[<span class="dv">3</span>]</span>
<span id="cb34-8"><a href="ca-analysis.html#cb34-8" aria-hidden="true" tabindex="-1"></a>  Cp <span class="ot">=</span> DOSE<span class="sc">/</span>V<span class="sc">*</span>Ka<span class="sc">/</span>(Ka <span class="sc">-</span> K)<span class="sc">*</span>(<span class="fu">exp</span>(<span class="sc">-</span>K<span class="sc">*</span>TIME) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>Ka<span class="sc">*</span>TIME)) <span class="co"># eq 2:1</span></span>
<span id="cb34-9"><a href="ca-analysis.html#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Cp)</span>
<span id="cb34-10"><a href="ca-analysis.html#cb34-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-11"><a href="ca-analysis.html#cb34-11" aria-hidden="true" tabindex="-1"></a>TIME <span class="ot">=</span> dPK02[,<span class="st">&quot;TIME&quot;</span>]</span>
<span id="cb34-12"><a href="ca-analysis.html#cb34-12" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">=</span> <span class="fu">nlr</span>(fPK02a, dPK02, <span class="at">pNames=</span><span class="fu">c</span>(<span class="st">&quot;ka&quot;</span>, <span class="st">&quot;V&quot;</span>, <span class="st">&quot;k&quot;</span>), <span class="at">IE=</span><span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">30</span>, <span class="fl">0.05</span>))</span>
<span id="cb34-13"><a href="ca-analysis.html#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="ca-analysis.html#cb34-14" aria-hidden="true" tabindex="-1"></a>r1<span class="sc">$</span>Est</span></code></pre></div>
<pre><code>##            ka      V         k AddErrVar AddErrSD
## PE   0.013202 21.018  0.013202   0.08701  0.29498
## SE   0.005442  8.623  0.005442   0.03413  0.05785
## RSE 41.220676 41.029 41.220716  39.22314 19.61157</code></pre>
</div>
<div id="compartmental-analysis-with-tlag" class="section level3" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Compartmental analysis with Tlag</h3>
<p>경구 투여 일구획 분석, 지연시간이 있는 모형이다. k<sub>a</sub>, V, k에 T<sub>lag</sub>가 추가되어 농도를 나타낼 수 있다.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="ca-analysis.html#cb36-1" aria-hidden="true" tabindex="-1"></a>fPK02b <span class="ot">=</span> <span class="cf">function</span>(THETA) <span class="co"># Prediction function</span></span>
<span id="cb36-2"><a href="ca-analysis.html#cb36-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb36-3"><a href="ca-analysis.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  Ka   <span class="ot">=</span> THETA[<span class="dv">1</span>]</span>
<span id="cb36-4"><a href="ca-analysis.html#cb36-4" aria-hidden="true" tabindex="-1"></a>  V    <span class="ot">=</span> THETA[<span class="dv">2</span>]</span>
<span id="cb36-5"><a href="ca-analysis.html#cb36-5" aria-hidden="true" tabindex="-1"></a>  K    <span class="ot">=</span> THETA[<span class="dv">3</span>]</span>
<span id="cb36-6"><a href="ca-analysis.html#cb36-6" aria-hidden="true" tabindex="-1"></a>  tlag <span class="ot">=</span> THETA[<span class="dv">4</span>]</span>
<span id="cb36-7"><a href="ca-analysis.html#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="ca-analysis.html#cb36-8" aria-hidden="true" tabindex="-1"></a>  Cp  <span class="ot">=</span> DOSE<span class="sc">/</span>V<span class="sc">*</span>Ka<span class="sc">/</span>(Ka <span class="sc">-</span> K)<span class="sc">*</span>(<span class="fu">exp</span>(<span class="sc">-</span>K<span class="sc">*</span>(TIME <span class="sc">-</span> tlag)) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>Ka<span class="sc">*</span>(TIME <span class="sc">-</span> tlag))) <span class="co"># eq 2:2</span></span>
<span id="cb36-9"><a href="ca-analysis.html#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Cp)</span>
<span id="cb36-10"><a href="ca-analysis.html#cb36-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-11"><a href="ca-analysis.html#cb36-11" aria-hidden="true" tabindex="-1"></a>TIME <span class="ot">=</span> dPK02[,<span class="st">&quot;TIME&quot;</span>]</span>
<span id="cb36-12"><a href="ca-analysis.html#cb36-12" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">=</span> <span class="fu">nlr</span>(fPK02b, dPK02, <span class="at">pNames=</span><span class="fu">c</span>(<span class="st">&quot;ka&quot;</span>, <span class="st">&quot;V&quot;</span>, <span class="st">&quot;k&quot;</span>, <span class="st">&quot;tlag&quot;</span>), <span class="at">IE=</span><span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">30</span>, <span class="fl">0.05</span>, <span class="dv">20</span>))</span>
<span id="cb36-13"><a href="ca-analysis.html#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="ca-analysis.html#cb36-14" aria-hidden="true" tabindex="-1"></a>r2<span class="sc">$</span>Est</span></code></pre></div>
<pre><code>##           ka      V         k    tlag AddErrVar
## PE   0.02747 27.354  0.010511 11.3754  0.015494
## SE   0.00606  4.149  0.001938  0.8676  0.006077
## RSE 22.06025 15.167 18.432707  7.6269 39.223384
##     AddErrSD
## PE   0.12448
## SE   0.02441
## RSE 19.61169</code></pre>
</div>
<div id="modeling-result" class="section level3" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Modeling Result</h3>
<p>위 두개의 모델을 비교할 때 지연 시간이 있는 모형의 적합이 더 좋은 것을 알 수 있다. C<sub>max</sub> 부분을 주의깊게 살펴야 한다.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="ca-analysis.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure 2.3, p 480</span></span>
<span id="cb38-2"><a href="ca-analysis.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dPK02[,<span class="st">&quot;TIME&quot;</span>], dPK02[,<span class="st">&quot;DV&quot;</span>], <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">400</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>), </span>
<span id="cb38-3"><a href="ca-analysis.html#cb38-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Time (min)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Concentration (ug/L)&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb38-4"><a href="ca-analysis.html#cb38-4" aria-hidden="true" tabindex="-1"></a>TIME <span class="ot">=</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">400</span></span>
<span id="cb38-5"><a href="ca-analysis.html#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(TIME, <span class="fu">fPK02a</span>(r1<span class="sc">$</span>Est[<span class="st">&quot;PE&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]), <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb38-6"><a href="ca-analysis.html#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(TIME, <span class="fu">fPK02b</span>(r2<span class="sc">$</span>Est[<span class="st">&quot;PE&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]))</span></code></pre></div>
<p><img src="pharmapk_files/figure-html/unnamed-chunk-29-1.svg" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="구획모델을-이용한-정맥주사-후-약동학-자료-분석" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> 1구획모델을 이용한 정맥주사 후 약동학 자료 분석</h2>
<p><code>wnl</code> 라이브러리를 불러오고 자료를 읽어온다.
이전 예제에서는 1명의 경구투약 후 농도 자료였고, 이번 예제는 4명의 IV 투약 후 농도 자료이다.
<code>hands-on2.csv</code><a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>를 읽어 들인 후 그림을 통해 자료의 탐색을 수행한다.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="ca-analysis.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wnl)</span>
<span id="cb39-2"><a href="ca-analysis.html#cb39-2" aria-hidden="true" tabindex="-1"></a>dPK01 <span class="ot">&lt;-</span>  <span class="fu">read.csv</span>(<span class="st">&quot;data/hands-on2.csv&quot;</span>, <span class="at">skip=</span><span class="dv">1</span>)</span>
<span id="cb39-3"><a href="ca-analysis.html#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dPK01) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;TIME&quot;</span>, <span class="st">&quot;DV&quot;</span>, <span class="st">&quot;ID&quot;</span>)</span>
<span id="cb39-4"><a href="ca-analysis.html#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="ca-analysis.html#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb39-6"><a href="ca-analysis.html#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dPK01, <span class="fu">aes</span>(TIME, DV, <span class="at">group =</span> ID, <span class="at">color =</span> <span class="fu">as.factor</span>(ID))) <span class="sc">+</span></span>
<span id="cb39-7"><a href="ca-analysis.html#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span></code></pre></div>
<p><img src="pharmapk_files/figure-html/unnamed-chunk-30-1.svg" width="100%" style="display: block; margin: auto;" /></p>
<ul>
<li>4명의 피험자 모두 대략적으로 시간에 따른 농도 감소가 단항 지수함수적인 것을 관찰할 수 있다.</li>
<li>피험자 1과 2를 비교하면 2번 피험자가 AUC가 더 작으며, 따라서 청소율이 더 클 것이라
예상할 수 있으며, Y 절편이 거의 같은 것으로 보아 분포용적이 유사할 것으로 보인다.<br />
</li>
<li>피험자 3과 4의 경우 곡선이 교차하는 형태로 눈으로는 어느 쪽이 AUC가 클지 알기 어렵고, Y절편에
해당하는 농도가 높은 쪽이 분포용적이 더 작을 것이라 예상할 수 있다.</li>
</ul>
<p>이러한 탐색을 수치적인 해석으로 확장하기 위해 4명 자료의 NCA 분석을 수행한다. 3장에서 다루었던 <code>tblNCA()</code> 함수를 사용해 계산할 수 있다.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="ca-analysis.html#cb40-1" aria-hidden="true" tabindex="-1"></a>NonCompart<span class="sc">::</span><span class="fu">tblNCA</span>(dPK01, <span class="at">key=</span><span class="st">&quot;ID&quot;</span>, <span class="at">colTime=</span><span class="st">&quot;TIME&quot;</span>, </span>
<span id="cb40-2"><a href="ca-analysis.html#cb40-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colConc=</span><span class="st">&quot;DV&quot;</span>, <span class="at">dose=</span><span class="dv">10</span>, <span class="at">adm=</span><span class="st">&quot;Bolus&quot;</span>)</span></code></pre></div>
<pre><code>##   ID    b0 CMAX CMAXD TMAX TLAG CLST  CLSTP TLST
## 1  1 6.919  920  92.0   10   NA  200 211.19  150
## 2  2 6.934  850  85.0   10   NA   42  45.18  150
## 3  3 6.878  800  80.0   10   NA   60  56.81  150
## 4  4 6.208  465  46.5   10   NA  120 117.19  150
##   LAMZHL     LAMZ LAMZLL LAMZUL LAMZNPT  CORRXY     R2
## 1  66.39 0.010441     10    150      10 -0.9943 0.9887
## 2  33.29 0.020824     10    150      10 -0.9951 0.9902
## 3  36.64 0.018919     10    150      10 -0.9984 0.9969
## 4  72.02 0.009625     10    150      10 -0.9972 0.9944
##    R2ADJ AUCLST AUCALL AUCIFO AUCIFOD AUCIFP AUCIFPD
## 1 0.9873  77590  77590  96745    9675  97818    9782
## 2 0.9890  48374  48374  50391    5039  50544    5054
## 3 0.9965  48431  48431  51602    5160  51434    5143
## 4 0.9937  39678  39678  52146    5215  51854    5185
##   AUCPEO AUCPEP AUMCLST AUMCIFO AUMCIFP AUMCPEO
## 1 19.800 20.679 4337000 9044967 9308475   52.05
## 2  4.003  4.292 1967000 2366394 2396605   16.88
## 3  6.146  5.838 2077250 2720574 2686362   23.65
## 4 23.910 23.482 2245250 5410815 5336766   58.50
##   AUMCPEP     C0 AUCPBEO AUCPBEP   VZO    VZP    CLO
## 1   53.41 1058.0  10.223  10.111  9.90  9.791 0.1034
## 2   17.93 1146.8  19.813  19.753  9.53  9.501 0.1984
## 3   22.67  941.2  16.871  16.926 10.24 10.276 0.1938
## 4   57.93  540.6   9.642   9.696 19.92 20.037 0.1918
##      CLP MRTIVLST MRTIVIFO MRTIVIFP   VSSO   VSSP
## 1 0.1022    55.90    93.49    95.16  9.664  9.728
## 2 0.1978    40.66    46.96    47.42  9.319  9.381
## 3 0.1944    42.89    52.72    52.23 10.217 10.155
## 4 0.1928    56.59   103.76   102.92 19.899 19.848</code></pre>
</div>
<div id="compartmental-analysis" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Compartmental analysis</h2>
<p>V, K만 있으면 단항 지수함수적 농도 감소를 보이는 IV dosing의 농도를 나타낼 수 있으므로 아래와 같이 간단한 함수를 만들 수 있다.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="ca-analysis.html#cb42-1" aria-hidden="true" tabindex="-1"></a>IDs <span class="ot">=</span> <span class="fu">unique</span>(dPK01[,<span class="st">&quot;ID&quot;</span>])</span>
<span id="cb42-2"><a href="ca-analysis.html#cb42-2" aria-hidden="true" tabindex="-1"></a>nID <span class="ot">=</span> <span class="fu">length</span>(IDs)</span>
<span id="cb42-3"><a href="ca-analysis.html#cb42-3" aria-hidden="true" tabindex="-1"></a>DOSE <span class="ot">=</span> <span class="dv">10000</span> <span class="co"># ug</span></span>
<span id="cb42-4"><a href="ca-analysis.html#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="ca-analysis.html#cb42-5" aria-hidden="true" tabindex="-1"></a>fPK01 <span class="ot">=</span> <span class="cf">function</span>(THETA) <span class="co"># Prediction function</span></span>
<span id="cb42-6"><a href="ca-analysis.html#cb42-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb42-7"><a href="ca-analysis.html#cb42-7" aria-hidden="true" tabindex="-1"></a>  V  <span class="ot">=</span> THETA[<span class="dv">1</span>]</span>
<span id="cb42-8"><a href="ca-analysis.html#cb42-8" aria-hidden="true" tabindex="-1"></a>  K  <span class="ot">=</span> THETA[<span class="dv">2</span>]</span>
<span id="cb42-9"><a href="ca-analysis.html#cb42-9" aria-hidden="true" tabindex="-1"></a>  Cp <span class="ot">=</span> DOSE<span class="sc">/</span>V<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>K<span class="sc">*</span>TIME)  <span class="co"># External DOSE, TIME, eq 1:2</span></span>
<span id="cb42-10"><a href="ca-analysis.html#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Cp)</span>
<span id="cb42-11"><a href="ca-analysis.html#cb42-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Subject군이 여러명일 경우 각각의 대상자의 값을 모두 구하기 위해서 <code>for</code> 함수를 사용하게 되는데, 다소 복잡해보이지만 <code>nlr</code> 함수를 여러번 사용하며 각 대상자의 약동학 파라메터 추정을 수행하는 것이 핵심이다.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="ca-analysis.html#cb43-1" aria-hidden="true" tabindex="-1"></a>Result <span class="ot">=</span> <span class="fu">vector</span>()</span>
<span id="cb43-2"><a href="ca-analysis.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nID) {</span>
<span id="cb43-3"><a href="ca-analysis.html#cb43-3" aria-hidden="true" tabindex="-1"></a>  cID <span class="ot">=</span> IDs[i]</span>
<span id="cb43-4"><a href="ca-analysis.html#cb43-4" aria-hidden="true" tabindex="-1"></a>  Data <span class="ot">=</span> dPK01[dPK01<span class="sc">$</span>ID <span class="sc">==</span> cID,]</span>
<span id="cb43-5"><a href="ca-analysis.html#cb43-5" aria-hidden="true" tabindex="-1"></a>  TIME <span class="ot">=</span> dPK01[dPK01<span class="sc">$</span>ID <span class="sc">==</span> cID,<span class="st">&quot;TIME&quot;</span>]</span>
<span id="cb43-6"><a href="ca-analysis.html#cb43-6" aria-hidden="true" tabindex="-1"></a>  Res <span class="ot">=</span> <span class="fu">nlr</span>(fPK01, Data, <span class="at">pNames=</span><span class="fu">c</span>(<span class="st">&quot;V&quot;</span>, <span class="st">&quot;k&quot;</span>), <span class="at">IE=</span><span class="fu">c</span>(<span class="dv">20</span>, <span class="fl">0.2</span>),</span>
<span id="cb43-7"><a href="ca-analysis.html#cb43-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">SecNames=</span><span class="fu">c</span>(<span class="st">&quot;CL&quot;</span>, <span class="st">&quot;AUC&quot;</span>, <span class="st">&quot;AUMC&quot;</span> , <span class="st">&quot;Thalf&quot;</span>, <span class="st">&quot;MRT&quot;</span>), </span>
<span id="cb43-8"><a href="ca-analysis.html#cb43-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">SecForms=</span><span class="fu">c</span>(<span class="sc">~</span>V<span class="sc">*</span>k, <span class="sc">~</span>DOSE<span class="sc">/</span>V<span class="sc">/</span>k, <span class="sc">~</span>DOSE<span class="sc">/</span>V<span class="sc">/</span>k<span class="sc">/</span>k, <span class="sc">~</span><span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">/</span>k, <span class="sc">~</span><span class="dv">1</span><span class="sc">/</span>k))</span>
<span id="cb43-9"><a href="ca-analysis.html#cb43-9" aria-hidden="true" tabindex="-1"></a>  Result <span class="ot">=</span> <span class="fu">rbind</span>(Result, <span class="fu">cbind</span>(<span class="at">ID=</span>cID, Res<span class="sc">$</span>Est))</span>
<span id="cb43-10"><a href="ca-analysis.html#cb43-10" aria-hidden="true" tabindex="-1"></a>} ; Result</span></code></pre></div>
<pre><code>##     ID       V         k AddErrVar AddErrSD       CL
## PE   1  9.9784 0.0102561    432.74   20.802 0.102340
## SE   1  0.1834 0.0003874    193.53    4.652 0.002597
## RSE  1  1.8382 3.7771994     44.72   22.361 2.537782
## PE   2  9.8162 0.0206613    753.97   27.459 0.202816
## SE   2  0.3308 0.0010188    337.19    6.140 0.005970
## RSE  2  3.3700 4.9308074     44.72   22.361 2.943762
## PE   3 10.2230 0.0190412     77.05    8.778 0.194658
## SE   3  0.1087 0.0003052     34.46    1.963 0.001891
## RSE  3  1.0630 1.6029349     44.72   22.361 0.971497
## PE   4 19.9472 0.0098140     72.19    8.497 0.195761
## SE   4  0.2954 0.0003071     32.29    1.900 0.004148
## RSE  4  1.4811 3.1291755     44.72   22.361 2.119026
##           AUC      AUMC   Thalf      MRT
## PE  9.771e+04 9.527e+06 67.5840  97.5031
## SE  2.480e+03 5.876e+05  2.5528   3.6829
## RSE 2.538e+00 6.167e+00  3.7772   3.7772
## PE  4.931e+04 2.386e+06 33.5481  48.3997
## SE  1.451e+03 1.763e+05  1.6542   2.3865
## RSE 2.944e+00 7.389e+00  4.9308   4.9308
## PE  5.137e+04 2.698e+06 36.4025  52.5177
## SE  4.991e+02 6.551e+04  0.5835   0.8418
## RSE 9.715e-01 2.428e+00  1.6029   1.6029
## PE  5.108e+04 5.205e+06 70.6287 101.8957
## SE  1.082e+03 2.673e+05  2.2101   3.1885
## RSE 2.119e+00 5.135e+00  3.1292   3.1292</code></pre>
<div id="modeling-result-1" class="section level3" number="5.6.1">
<h3><span class="header-section-number">5.6.1</span> Modeling Result</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="ca-analysis.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure 1.1, p 470</span></span>
<span id="cb45-2"><a href="ca-analysis.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">type=</span><span class="st">&quot;n&quot;</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">160</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">1000</span>), <span class="at">log=</span><span class="st">&quot;y&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Time (min)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Concentration (ug/L)&quot;</span>)</span>
<span id="cb45-3"><a href="ca-analysis.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nID) {</span>
<span id="cb45-4"><a href="ca-analysis.html#cb45-4" aria-hidden="true" tabindex="-1"></a>  cID <span class="ot">=</span> IDs[i]</span>
<span id="cb45-5"><a href="ca-analysis.html#cb45-5" aria-hidden="true" tabindex="-1"></a>  TIME <span class="ot">=</span> dPK01[dPK01<span class="sc">$</span>ID <span class="sc">==</span> cID,<span class="st">&quot;TIME&quot;</span>]</span>
<span id="cb45-6"><a href="ca-analysis.html#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(TIME, dPK01[dPK01<span class="sc">$</span>ID <span class="sc">==</span> cID,<span class="st">&quot;DV&quot;</span>], <span class="at">pch=</span><span class="dv">14</span><span class="sc">+</span>i)</span>
<span id="cb45-7"><a href="ca-analysis.html#cb45-7" aria-hidden="true" tabindex="-1"></a>  cTHETA <span class="ot">=</span> Result[Result[,<span class="st">&quot;ID&quot;</span>]<span class="sc">==</span>cID <span class="sc">&amp;</span> <span class="fu">rownames</span>(Result)<span class="sc">==</span><span class="st">&quot;PE&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;V&quot;</span>, <span class="st">&quot;k&quot;</span>)]</span>
<span id="cb45-8"><a href="ca-analysis.html#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(TIME, <span class="fu">fPK01</span>(cTHETA))   </span>
<span id="cb45-9"><a href="ca-analysis.html#cb45-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="pharmapk_files/figure-html/unnamed-chunk-34-1.svg" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="구획모델-경구-흡수-이용한-약동학-자료-분석" class="section level2" number="5.7">
<h2><span class="header-section-number">5.7</span> 2구획모델 경구 흡수 이용한 약동학 자료 분석</h2>
<p><code>wnl</code> 라이브러리를 불러오고 자료를 읽어온다.
<code>hands-on3.csv</code><a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a>를 읽어 들인 후 모델링을 수행한다.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="ca-analysis.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wnl)</span>
<span id="cb46-2"><a href="ca-analysis.html#cb46-2" aria-hidden="true" tabindex="-1"></a>dPK14 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/hands-on3.csv&quot;</span>, <span class="at">skip=</span><span class="dv">1</span>)</span>
<span id="cb46-3"><a href="ca-analysis.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dPK14) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;TIME&quot;</span>, <span class="st">&quot;DV&quot;</span>) ; dPK14</span></code></pre></div>
<pre><code>##      TIME     DV
## 1   0.083  13.90
## 2   0.167 152.00
## 3   0.250 226.00
## 4   0.500 204.00
## 5   1.000 149.00
## 6   1.500 100.00
## 7   2.000  66.00
## 8   3.000  36.00
## 9   4.000  17.70
## 10  6.000   6.90
## 11  8.000   3.96
## 12 12.000   2.89
## 13 24.000   0.90
## 14 25.000   0.90</code></pre>
<div id="compartmental-analysis-without-tlag-1" class="section level3" number="5.7.1">
<h3><span class="header-section-number">5.7.1</span> Compartmental analysis without Tlag</h3>
<p>아래의 코드는 경구 투여 2구획 분석, 지연시간이 없는 모형이다.
2차 지수로 감소하는 약물에서의 약동학 모형이여,이때의 농도 값(Cp)을 구하기 위한 공식을 사용하였으며, Ka, Vc, k21, alpha, beta 로 농도를 나타낼 수 있다.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="ca-analysis.html#cb48-1" aria-hidden="true" tabindex="-1"></a>Dpo <span class="ot">=</span> <span class="dv">23158</span></span>
<span id="cb48-2"><a href="ca-analysis.html#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="ca-analysis.html#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="do">## without lag</span></span>
<span id="cb48-4"><a href="ca-analysis.html#cb48-4" aria-hidden="true" tabindex="-1"></a>fPK14a <span class="ot">=</span> <span class="cf">function</span>(THETA)</span>
<span id="cb48-5"><a href="ca-analysis.html#cb48-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb48-6"><a href="ca-analysis.html#cb48-6" aria-hidden="true" tabindex="-1"></a>  Vc  <span class="ot">=</span> THETA[<span class="dv">1</span>]</span>
<span id="cb48-7"><a href="ca-analysis.html#cb48-7" aria-hidden="true" tabindex="-1"></a>  Ka  <span class="ot">=</span> THETA[<span class="dv">2</span>]</span>
<span id="cb48-8"><a href="ca-analysis.html#cb48-8" aria-hidden="true" tabindex="-1"></a>  k21 <span class="ot">=</span> THETA[<span class="dv">3</span>]</span>
<span id="cb48-9"><a href="ca-analysis.html#cb48-9" aria-hidden="true" tabindex="-1"></a>  a   <span class="ot">=</span> THETA[<span class="dv">4</span>] <span class="co"># alpha</span></span>
<span id="cb48-10"><a href="ca-analysis.html#cb48-10" aria-hidden="true" tabindex="-1"></a>  b   <span class="ot">=</span> THETA[<span class="dv">5</span>] <span class="co"># beta</span></span>
<span id="cb48-11"><a href="ca-analysis.html#cb48-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-12"><a href="ca-analysis.html#cb48-12" aria-hidden="true" tabindex="-1"></a>  T1 <span class="ot">=</span> e<span class="sc">$</span>DATA[,<span class="st">&quot;TIME&quot;</span>]</span>
<span id="cb48-13"><a href="ca-analysis.html#cb48-13" aria-hidden="true" tabindex="-1"></a>  Co <span class="ot">=</span> Ka<span class="sc">*</span>Dpo<span class="sc">/</span>Vc<span class="sc">*</span>((k21<span class="sc">-</span>a)<span class="sc">/</span>(Ka<span class="sc">-</span>a)<span class="sc">/</span>(b<span class="sc">-</span>a)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>a<span class="sc">*</span>T1) <span class="sc">+</span> </span>
<span id="cb48-14"><a href="ca-analysis.html#cb48-14" aria-hidden="true" tabindex="-1"></a>                    (k21<span class="sc">-</span>b)<span class="sc">/</span>(Ka<span class="sc">-</span>b)<span class="sc">/</span>(a<span class="sc">-</span>b)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>b<span class="sc">*</span>T1) <span class="sc">+</span> </span>
<span id="cb48-15"><a href="ca-analysis.html#cb48-15" aria-hidden="true" tabindex="-1"></a>                    (k21<span class="sc">-</span>Ka)<span class="sc">/</span>(a<span class="sc">-</span>Ka)<span class="sc">/</span>(b<span class="sc">-</span>Ka)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>Ka<span class="sc">*</span>T1)) <span class="co"># Erratum in eq 14:1</span></span>
<span id="cb48-16"><a href="ca-analysis.html#cb48-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-17"><a href="ca-analysis.html#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Co)</span>
<span id="cb48-18"><a href="ca-analysis.html#cb48-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-19"><a href="ca-analysis.html#cb48-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-20"><a href="ca-analysis.html#cb48-20" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> <span class="fu">nlr</span>(fPK14a, dPK14, </span>
<span id="cb48-21"><a href="ca-analysis.html#cb48-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">pNames=</span><span class="fu">c</span>(<span class="st">&quot;Vc/F&quot;</span>, <span class="st">&quot;Ka&quot;</span>, <span class="st">&quot;k21&quot;</span>, <span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;beta&quot;</span>), </span>
<span id="cb48-22"><a href="ca-analysis.html#cb48-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">IE=</span><span class="fu">c</span>(<span class="dv">350</span>, <span class="dv">11</span>, <span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fl">0.01</span>))</span>
<span id="cb48-23"><a href="ca-analysis.html#cb48-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-24"><a href="ca-analysis.html#cb48-24" aria-hidden="true" tabindex="-1"></a>r1<span class="sc">$</span>Est</span></code></pre></div>
<pre><code>##      Vc/F     Ka      k21  alpha     beta AddErrVar
## PE  43.59  2.347   0.6955  2.347   0.3960    537.13
## SE  40.96  2.240   0.9594  2.241   0.4919    202.99
## RSE 93.98 95.439 137.9449 95.482 124.2005     37.79
##     AddErrSD
## PE    23.176
## SE     4.379
## RSE   18.896</code></pre>
</div>
<div id="compartmental-analysis-with-tlag-1" class="section level3" number="5.7.2">
<h3><span class="header-section-number">5.7.2</span> Compartmental analysis with Tlag</h3>
<p>경구 투여 2구획 분석, 지연시간이 있는 모형이다. Ka, V, k21, alpha, beta 에 Tlag가 추가되어 농도를 나타낼 수 있다.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="ca-analysis.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="do">## with lag</span></span>
<span id="cb50-2"><a href="ca-analysis.html#cb50-2" aria-hidden="true" tabindex="-1"></a>fPK14b <span class="ot">=</span> <span class="cf">function</span>(THETA)</span>
<span id="cb50-3"><a href="ca-analysis.html#cb50-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb50-4"><a href="ca-analysis.html#cb50-4" aria-hidden="true" tabindex="-1"></a>  Vc  <span class="ot">=</span> THETA[<span class="dv">1</span>]</span>
<span id="cb50-5"><a href="ca-analysis.html#cb50-5" aria-hidden="true" tabindex="-1"></a>  Ka  <span class="ot">=</span> THETA[<span class="dv">2</span>]</span>
<span id="cb50-6"><a href="ca-analysis.html#cb50-6" aria-hidden="true" tabindex="-1"></a>  k21 <span class="ot">=</span> THETA[<span class="dv">3</span>]</span>
<span id="cb50-7"><a href="ca-analysis.html#cb50-7" aria-hidden="true" tabindex="-1"></a>  a   <span class="ot">=</span> THETA[<span class="dv">4</span>] <span class="co"># alpha</span></span>
<span id="cb50-8"><a href="ca-analysis.html#cb50-8" aria-hidden="true" tabindex="-1"></a>  b   <span class="ot">=</span> THETA[<span class="dv">5</span>] <span class="co"># beta</span></span>
<span id="cb50-9"><a href="ca-analysis.html#cb50-9" aria-hidden="true" tabindex="-1"></a>  TL  <span class="ot">=</span> THETA[<span class="dv">6</span>] <span class="co"># Tlag</span></span>
<span id="cb50-10"><a href="ca-analysis.html#cb50-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-11"><a href="ca-analysis.html#cb50-11" aria-hidden="true" tabindex="-1"></a>  T1 <span class="ot">=</span> e<span class="sc">$</span>DATA[,<span class="st">&quot;TIME&quot;</span>]</span>
<span id="cb50-12"><a href="ca-analysis.html#cb50-12" aria-hidden="true" tabindex="-1"></a>  Co <span class="ot">=</span> Ka<span class="sc">*</span>Dpo<span class="sc">/</span>Vc<span class="sc">*</span>((k21<span class="sc">-</span>a)<span class="sc">/</span>(Ka<span class="sc">-</span>a)<span class="sc">/</span>(b<span class="sc">-</span>a)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>a<span class="sc">*</span>(T1<span class="sc">-</span>TL)) <span class="sc">+</span> </span>
<span id="cb50-13"><a href="ca-analysis.html#cb50-13" aria-hidden="true" tabindex="-1"></a>                    (k21<span class="sc">-</span>b)<span class="sc">/</span>(Ka<span class="sc">-</span>b)<span class="sc">/</span>(a<span class="sc">-</span>b)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>b<span class="sc">*</span>(T1<span class="sc">-</span>TL)) <span class="sc">+</span> </span>
<span id="cb50-14"><a href="ca-analysis.html#cb50-14" aria-hidden="true" tabindex="-1"></a>                    (k21<span class="sc">-</span>Ka)<span class="sc">/</span>(a<span class="sc">-</span>Ka)<span class="sc">/</span>(b<span class="sc">-</span>Ka)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>Ka<span class="sc">*</span>(T1<span class="sc">-</span>TL))) </span>
<span id="cb50-15"><a href="ca-analysis.html#cb50-15" aria-hidden="true" tabindex="-1"></a>  Co[Co <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="dv">0</span> <span class="co"># remove negative concentrations before tlag</span></span>
<span id="cb50-16"><a href="ca-analysis.html#cb50-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-17"><a href="ca-analysis.html#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Co)</span>
<span id="cb50-18"><a href="ca-analysis.html#cb50-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-19"><a href="ca-analysis.html#cb50-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-20"><a href="ca-analysis.html#cb50-20" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">nlr</span>(fPK14b, dPK14, </span>
<span id="cb50-21"><a href="ca-analysis.html#cb50-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">pNames=</span><span class="fu">c</span>(<span class="st">&quot;Vc/F&quot;</span>, <span class="st">&quot;Ka&quot;</span>, <span class="st">&quot;k21&quot;</span>, <span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;Tlag&quot;</span>), </span>
<span id="cb50-22"><a href="ca-analysis.html#cb50-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">IE=</span><span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">11</span>, <span class="fl">0.12</span>, <span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>))</span>
<span id="cb50-23"><a href="ca-analysis.html#cb50-23" aria-hidden="true" tabindex="-1"></a>r2<span class="sc">$</span>Est</span></code></pre></div>
<pre><code>##       Vc/F     Ka       k21   alpha      beta    Tlag
## PE  88.528 19.767 7.902e-03 0.73176 1.976e-03 0.12163
## SE   2.315  3.763 1.243e-01 0.04575 1.129e-01 0.00812
## RSE  2.615 19.036 1.573e+03 6.25139 5.713e+03 6.67610
##     AddErrVar AddErrSD
## PE     17.894   4.2301
## SE      6.851   0.8098
## RSE    38.288  19.1441</code></pre>
</div>
<div id="modeling-result-2" class="section level3" number="5.7.3">
<h3><span class="header-section-number">5.7.3</span> Modeling Result</h3>
<p>지연 시간이 있는 모형의 적합이 더 좋은 것을 알 수 있다. 특히 C<sub>max</sub> 부분에서의 적합 차이를 주의해서 살펴 볼 필요가 있다.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="ca-analysis.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dPK14[,<span class="st">&quot;TIME&quot;</span>], dPK14[,<span class="st">&quot;DV&quot;</span>], <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">250</span>), <span class="at">xlab=</span><span class="st">&quot;Time (min)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Concentration (ug/L)&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb52-2"><a href="ca-analysis.html#cb52-2" aria-hidden="true" tabindex="-1"></a>TIME <span class="ot">=</span> dPK14[,<span class="st">&quot;TIME&quot;</span>]</span>
<span id="cb52-3"><a href="ca-analysis.html#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(TIME, <span class="fu">fPK14a</span>(r1<span class="sc">$</span>Est[<span class="st">&quot;PE&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]), <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb52-4"><a href="ca-analysis.html#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(TIME, <span class="fu">fPK14b</span>(r2<span class="sc">$</span>Est[<span class="st">&quot;PE&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]))</span></code></pre></div>
<p><img src="pharmapk_files/figure-html/unnamed-chunk-38-1.svg" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="theoph-약동학-자료의-구획분석" class="section level2" number="5.8">
<h2><span class="header-section-number">5.8</span> Theoph 약동학 자료의 구획분석</h2>
<p>R에 내장된 Theoph 약동학 자료의 구획분석을 아래의 코드를 사용하여 수행한다. Minimization이 된 후 1구획 약동학 모형에서 언급된 파라미터 이외에 다른 파라미터에 대해서도 값을 구하기 위해서 다음과 같이 (CL(제거 속도), T<sub>half</sub>(반감기), MRT(평균 체류 시간)) 추가적으로 넣어준 후, 입력한 파라미터값들을 구하기 위한 수식을 뒤쪽 부분’SecForms’ 인자에 입력하게 된다. 이런 방법을 통하여 우리가 원하는 파라미터들의 점추정치와(point estimate), 그리고 표준 오차(standard error of estimates)를 모두 구할 수 있다.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="ca-analysis.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wnl)</span>
<span id="cb53-2"><a href="ca-analysis.html#cb53-2" aria-hidden="true" tabindex="-1"></a>tData <span class="ot">=</span> Theoph</span>
<span id="cb53-3"><a href="ca-analysis.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tData) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;BWT&quot;</span>, <span class="st">&quot;DOSE&quot;</span>, <span class="st">&quot;TIME&quot;</span>, <span class="st">&quot;DV&quot;</span>)</span>
<span id="cb53-4"><a href="ca-analysis.html#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="ca-analysis.html#cb53-5" aria-hidden="true" tabindex="-1"></a>fPK <span class="ot">=</span> <span class="cf">function</span>(THETA)     <span class="co"># Prediction function</span></span>
<span id="cb53-6"><a href="ca-analysis.html#cb53-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb53-7"><a href="ca-analysis.html#cb53-7" aria-hidden="true" tabindex="-1"></a>  DOSE <span class="ot">=</span> <span class="dv">320000</span>           <span class="co"># in microgram</span></span>
<span id="cb53-8"><a href="ca-analysis.html#cb53-8" aria-hidden="true" tabindex="-1"></a>  TIME <span class="ot">=</span> e<span class="sc">$</span>DATA[,<span class="st">&quot;TIME&quot;</span>]  <span class="co"># use data in e$DATA</span></span>
<span id="cb53-9"><a href="ca-analysis.html#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="ca-analysis.html#cb53-10" aria-hidden="true" tabindex="-1"></a>  K    <span class="ot">=</span> THETA[<span class="dv">1</span>]</span>
<span id="cb53-11"><a href="ca-analysis.html#cb53-11" aria-hidden="true" tabindex="-1"></a>  Ka   <span class="ot">=</span> THETA[<span class="dv">2</span>]</span>
<span id="cb53-12"><a href="ca-analysis.html#cb53-12" aria-hidden="true" tabindex="-1"></a>  V    <span class="ot">=</span> THETA[<span class="dv">3</span>]</span>
<span id="cb53-13"><a href="ca-analysis.html#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="ca-analysis.html#cb53-14" aria-hidden="true" tabindex="-1"></a>  Cp   <span class="ot">=</span> DOSE<span class="sc">/</span>V<span class="sc">*</span>Ka<span class="sc">/</span>(Ka <span class="sc">-</span> K)<span class="sc">*</span>(<span class="fu">exp</span>(<span class="sc">-</span>K<span class="sc">*</span>TIME) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>Ka<span class="sc">*</span>TIME))</span>
<span id="cb53-15"><a href="ca-analysis.html#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Cp)</span>
<span id="cb53-16"><a href="ca-analysis.html#cb53-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-17"><a href="ca-analysis.html#cb53-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-18"><a href="ca-analysis.html#cb53-18" aria-hidden="true" tabindex="-1"></a>IDs <span class="ot">=</span> <span class="fu">unique</span>(tData[,<span class="st">&quot;ID&quot;</span>])</span>
<span id="cb53-19"><a href="ca-analysis.html#cb53-19" aria-hidden="true" tabindex="-1"></a>nID <span class="ot">=</span> <span class="fu">length</span>(IDs)</span>
<span id="cb53-20"><a href="ca-analysis.html#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nID) {</span>
<span id="cb53-21"><a href="ca-analysis.html#cb53-21" aria-hidden="true" tabindex="-1"></a>  Data <span class="ot">=</span> tData[tData<span class="sc">$</span>ID <span class="sc">==</span> IDs[i],]</span>
<span id="cb53-22"><a href="ca-analysis.html#cb53-22" aria-hidden="true" tabindex="-1"></a>  Res <span class="ot">=</span> <span class="fu">nlr</span>(fPK, Data, <span class="at">pNames=</span><span class="fu">c</span>(<span class="st">&quot;k&quot;</span>, <span class="st">&quot;ka&quot;</span>, <span class="st">&quot;V&quot;</span>), <span class="at">IE=</span><span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">3</span>, <span class="dv">500</span>), </span>
<span id="cb53-23"><a href="ca-analysis.html#cb53-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">SecNames=</span><span class="fu">c</span>(<span class="st">&quot;CL&quot;</span>, <span class="st">&quot;Thalf&quot;</span>, <span class="st">&quot;MRT&quot;</span>), </span>
<span id="cb53-24"><a href="ca-analysis.html#cb53-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">SecForms=</span><span class="fu">c</span>(<span class="sc">~</span>V<span class="sc">*</span>k, <span class="sc">~</span><span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">/</span>k, <span class="sc">~</span><span class="dv">1</span><span class="sc">/</span>k))</span>
<span id="cb53-25"><a href="ca-analysis.html#cb53-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;## ID =&quot;</span>, i, <span class="st">&quot;##&quot;</span>))</span>
<span id="cb53-26"><a href="ca-analysis.html#cb53-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(Res)</span>
<span id="cb53-27"><a href="ca-analysis.html#cb53-27" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="결론" class="section level2" number="5.9">
<h2><span class="header-section-number">5.9</span> 결론</h2>
<p>이상으로 구획모델링(compartment modeling)에 대한 간략한 이론과 실제 자료해석을 R 코드를 사용해서 알아보았다.
이는 단순하지만 여러 현상을 묘사할 수 있는 유용한 도구 중 하나이다.
즉, 간단한 수식으로 구성된 모델을 통해 현상을 분석하고 여러 변수를 연관시킨 후, 시뮬레이션을 통한 새로운 정보의 생성을 수행할 수 있다.</p>

</div>
</div>
<h3>참고문헌</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-R-wnl" class="csl-entry">
———. 2020c. <em>Wnl: Minimization Tool for Pharmacokinetic-Pharmacodynamic Data Analysis</em>. <a href="https://cran.r-project.org/package=wnl">https://cran.r-project.org/package=wnl</a>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="4">
<li id="fn4"><p>최대 우도 측정법 (maximum likelihood estimation method)은 점 추정치를 찾는데까지는 오래 걸리나, 표준 오차(standard error of estimates)를 구하는게 유리하다. 최근에는 최소 제곱법(Least square method) 보다 널리 쓰이고 있다.<a href="ca-analysis.html#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p><a href="https://github.com/pipetcpt/pharmapk/blob/master/data.zip" class="uri">https://github.com/pipetcpt/pharmapk/blob/master/data.zip</a><a href="ca-analysis.html#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p><a href="https://github.com/pipetcpt/pharmapk/blob/master/data.zip" class="uri">https://github.com/pipetcpt/pharmapk/blob/master/data.zip</a><a href="ca-analysis.html#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p><a href="https://github.com/pipetcpt/pharmapk/blob/master/data.zip" class="uri">https://github.com/pipetcpt/pharmapk/blob/master/data.zip</a><a href="ca-analysis.html#fnref7" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ca-principle.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="참고문헌.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/pipetcpt/basic/edit/master/inst/examples/05.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["pharmapk.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": false,
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
